---
title: "PracticaFinalSílvia"
author: "Sílvia Moià Canyelles"
date: "2024-01-31"
output: html_document
---
## Based on our lifestyle, what’s the probability of having depression?
We read the clean data set
```{r}
cdf <- read.csv("FPdata_CLEAN.csv")
```
We normalize the data
```{r}
normalize <- function(x) {
  return ((x - min(x)) / (max(x) - min(x)))
}

columns_to_normalize <- c("PhysicalHealthDays", "MentalHealthDays", "SleepHours")
cdf[columns_to_normalize] <- lapply(cdf[columns_to_normalize], normalize)

```

First of all, to answer this question, since we don't live in the United States, we need to train the model without the state variable. This way the model will be trained with the same information we are going to be able to fill.
```{r}
set.seed(43)

predictor_cols <- setdiff(colnames(cdf), "State")
dfSinState <- cdf[, predictor_cols]
```
Once we have the data set with all the data we need, we separate the training set from the test set. We create the model using the training data and we print the results. We see that the model works pretty good. It has about a 83% of precission.
We are going to solve this question with linear regression. As the dependent variable we are going to have "HadDepressiveDisorder" since it's the value we want to predict. The rest of the variables are going to be the independent ones.
```{r}
ind <- sample(2, nrow(dfSinState), replace=TRUE, prob=c(0.70, 0.30))

train_indices <- sample(1:nrow(dfSinState), 0.75 * nrow(dfSinState))
train_data <- dfSinState[ind==1,]
test_data <- dfSinState[ind==2,]

model <- glm(train_data$HadDepressiveDisorder ~ ., data = train_data, family=binomial(link=logit))
summary(model)

predicciones <- predict(model, newdata = test_data, type = "response")
etiquetas_reales <- test_data$HadDepressiveDisorder

prediccionesOverride <- ifelse(predicciones > 0.5, 1, 0)

precision <- mean(prediccionesOverride == etiquetas_reales)
cat("Model precission:", precision)
```
Now we want to predict if we are going to suffer from depression. We read the csv with our information. Which we have created already clean according to the cleaning done to the given data set. Meaning that we have directly used 0 or 1 to indicate gender or if we had some disease, or used the age categories directly instead of putting our age. This means that this data looks exactly like the one we cleaned so we can use the same model we have trained to predict our personal result.
```{r}
ourDatadf <-  read.csv("OurData.csv")
str(ourDatadf)
OurPredictions <- predict(model, newdata = ourDatadf , type="response")
print(OurPredictions)
```
All the answers are above 0.5, this means that the prediction for all 5 of us is that we are going to have depression.